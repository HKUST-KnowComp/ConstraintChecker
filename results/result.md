
Full results (~ three runs for each baseline).

## CKBPv2

Run the following code to produce Prior Best/Human result
```{=python}
# get PseudoReasoner result
path="results/roberta-large_bs32_evalstep250/pseudo_lr1e-05_decay1_step100000_evalstep250/_ckbp2_sep_pseudo_all_resume/"

for seed in 100 101 102
do
CUDA_VISIBLE_DEVICES=6 python models/pseudo_labeling/scoring_kgbert.py \
    --ptlm roberta-large \
    --model_path ${path}/best_model_seed_${seed}.pth \
    --tokenizer ${path}/best_tokenizer/ \
    --output_dir results \
    --scorer_name pseudoreasoner/seed_${seed} \
    --evaluation_file_path data/ckbp_csv/emnlp2023/ckbp2.0.csv
done

df = pd.read_csv('../PseudoReasoner/annotation/ckbp2.0_raw_agg_w_expert_labels.csv')
df['label1'][df['label1'] == 0.5] = 0
df['label2'][df['label2'] == 0.5] = 0
df['label1'].astype(int).to_csv('results/pseudoreasoner_and_human/human1.csv', index=False)
df['label2'].astype(int).to_csv('results/pseudoreasoner_and_human/human2.csv', index=False)
```

Run the following code to aggregate baseline result
```{=python}
taken_fields = [1,2,3,9,10,11,12,13,4]
num_baselines = 8

results = """<copy result of baselines here>"""
results = results.splitlines()

for i in range(len(results)//3):
  score = [0]*19
  for j in range(3):
    for k, s in enumerate(results[3*i+j][:-1].rsplit('|', 19)[1:]):
      score[k] += float(s)
  print(f'>{i}>', ' & '.join([str(round(score[_]/3, 2)) for _ in taken_fields]))

results = """<copy all result of one model except least2most here>"""
results = results.splitlines()
for i in [0,1,2,3,4]:
  for section in [0,1,2,3]:
    score = [0]*19
    for j in range(3):
      for k, s in enumerate(results[(3*num_baselines+1)*section + 3*i+j+1][:-1].rsplit('|', 19)[1:]):
        score[k] += float(s)
    print(f'>{i}>', ' & '.join([str(round(score[_]/3, 2)) for _ in taken_fields]))
```

Run the following code to get baseline result of each run
```{=bash}
for model in gpt3.5-turbo davinci
  do
  for setting in "_no_exemplar" "" 
  do
    for i in 1 2 3
      do python prompting/scoring.py -s tst -q l2m \
      -p tst_${model}_naive_prompt${i}.txt \
      --q0 tst_${model}_least2most_prompt${i}${setting}.csv
    done
  done
done

for model in gpt3.5-turbo davinci
  do
  for setting in naive random_5shot kate_5shot kate_5shot_same_relation zeroshot randomcot activecot automatecot
  do
    for i in 1 2 3
    do python prompting/scoring.py -s tst -q moe \
      --q1 tst_${model}_moe_q1_prompt1.txt \
      --q3 tst_${model}_moe_q3_prompt3.txt \
      --q0 tst_${model}_${setting}_prompt${i}.txt
    done
  done
done

for i in 1 2 3; do python prompting/scoring.py -s tst -q 0   -p tst_pseudoreasoner${i}.txt; done
for i in 1 2; do python prompting/scoring.py -s tst -q 0   -p tst_human${i}.txt; done
```

Full result table on test_data_to_eval. The main metric is F1. Relation stands for F1 score on that subset.
Here, `naive` stands for non-CoT prompting. `naive i` is zero-shot, while `naive + .. exemplars` is few-shot ..

|Setting|Alias|AUC|Acc|Precision|Recall|**F1**|xWant|oWant|xEffect|oEffect|xReact|oReact|xAttr|xIntent|xNeed|Causes|isBefore|isAfter|HinderedBy|HasSubEvent|
|---|---|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|
|-- gpt3.5-turbo --
|l2m w/o exemplars 1|least2most_prompt1_no_exemplar|62.97|65.17|32.45|59.13|41.91|48.00|23.08|51.85|70.59|43.75|33.33|44.16|26.67|29.79|44.44|52.63|48.00|29.17|66.67|
|l2m w/o exemplars 2|least2most_prompt2_no_exemplar|65.92|70.38|37.35|58.17|45.49|49.38|48.28|54.55|66.67|40.00|50.00|50.00|33.33|8.00|38.10|47.06|43.48|33.33|57.14|
|l2m w/o exemplars 3|least2most_prompt3_no_exemplar|66.33|69.36|36.71|61.06|45.85|57.89|32.00|51.43|63.16|52.31|46.15|36.14|11.76|35.00|50.00|57.14|33.33|41.51|66.67|
|l2m (3 exemplars) 1|least2most_prompt1|64.92|67.42|34.71|60.58|44.13|48.00|23.08|51.85|70.59|62.96|61.54|39.44|15.38|37.04|44.44|52.63|48.00|29.17|66.67|
|l2m (3 exemplars) 2|least2most_prompt2|69.11|69.87|38.21|67.79|48.87|49.38|48.28|54.55|66.67|64.00|42.86|47.06|18.18|50.85|38.10|47.06|43.48|33.33|57.14|
|l2m (3 exemplars) 3|least2most_prompt3|61.00|66.50|32.04|51.44|39.48|57.89|32.00|51.43|63.16|29.51|11.76|8.00|6.90|40.82|50.00|57.14|33.33|41.51|66.67|
|-- ablation (shouldn't combine. Just show the effect of each constraint. Already has q1_prompt1, q3_prompt3, q1_prompt1 + q3_prompt3)
|naive 1 + q1_prompt2||64.54|67.93|34.86|58.65|43.73|48.00|23.08|51.85|70.59|56.52|40.00|49.06|29.63|35.71|44.44|52.63|48.00|29.17|66.67|
|naive 2 + q1_prompt2||69.73|69.46|38.12|70.19|49.41|49.38|48.28|54.55|66.67|60.38|20.00|53.12|43.75|52.63|38.10|47.06|43.48|33.33|57.14|
|naive 3 + q1_prompt2||70.15|73.44|41.88|64.42|50.76|57.89|32.00|51.43|63.16|61.22|25.00|56.14|40.00|50.00|50.00|57.14|33.33|41.51|66.67|
|naive 1 + q3_prompt1||63.61|67.01|33.80|57.69|42.63|48.00|23.08|51.85|70.59|49.23|50.00|46.38|14.29|18.18|44.44|52.63|48.00|29.17|66.67|
|naive 2 + q3_prompt1||67.27|67.52|35.82|66.83|46.64|49.38|48.28|54.55|66.67|52.78|35.29|49.44|33.33|19.35|38.10|47.06|43.48|33.33|57.14|
|naive 3 + q3_prompt1||68.54|72.01|39.88|62.50|48.69|57.89|32.00|51.43|63.16|56.25|40.00|53.85|30.77|14.29|50.00|57.14|33.33|41.51|66.67|
|naive 1 + (q3_prompt3 on all relations)||60.59|70.28|34.34|43.75|38.48|31.37|19.05|39.29|40.00|45.45|66.67|46.38|34.78|40.00|28.57|52.63|48.00|24.00|66.67|
|naive 2 + (q3_prompt3 on all relations)||63.40|70.28|36.03|51.44|42.38|29.09|31.58|47.37|26.67|45.83|46.15|49.44|51.85|53.06|25.00|47.06|43.48|27.45|57.14|
|naive 3 + (q3_prompt3 on all relations)||63.72|73.54|39.59|46.63|42.83|30.77|22.22|42.25|30.77|44.44|50.00|53.85|48.00|52.38|40.00|57.14|33.33|31.82|66.67|
|naive 1 + q2_prompt1||55.91|77.83|44.58|17.79|25.43|38.30|21.05|22.22|72.73|31.25|33.33|27.78|13.33|0.00|36.36|60.00|0.00|0.00|0.00|
|naive 2 + q2_prompt1||56.21|78.86|50.72|16.83|25.27|43.90|0.00|25.53|60.00|25.00|33.33|26.32|14.29|0.00|20.00|50.00|16.67|0.00|50.00|
|naive 3 + q2_prompt1||56.57|75.28|37.31|24.04|29.24|41.51|20.00|25.45|61.54|37.21|57.14|26.92|13.33|8.70|18.18|50.00|16.67|10.00|33.33|
|naive 1 + q2_prompt2||61.31|77.22|45.16|33.65|38.57|45.90|41.67|55.17|76.92|38.10|40.00|37.21|34.78|8.33|36.36|72.73|0.00|0.00|28.57|
|naive 2 + q2_prompt2||58.29|76.61|41.98|26.44|32.45|48.98|11.76|49.23|66.67|27.91|25.00|27.27|21.05|0.00|20.00|57.14|12.50|0.00|40.00|
|naive 3 + q2_prompt2||62.66|69.66|35.12|50.48|41.42|50.67|28.57|47.19|50.00|50.00|61.54|38.96|36.36|7.69|37.50|70.59|23.53|10.00|33.33|
|naive 1 + q1_prompt1||64.41|65.78|33.51|62.02|43.51|48.00|23.08|51.85|70.59|50.00|50.00|47.06|29.63|35.71|44.44|52.63|48.00|29.17|66.67|
|naive 2 + q1_prompt1||69.86|66.91|36.45|75.00|49.06|49.38|48.28|54.55|66.67|55.07|35.29|51.16|43.75|52.63|38.10|47.06|43.48|33.33|57.14|
|naive 3 + q1_prompt1||70.80|71.71|40.34|69.23|50.97|57.89|32.00|51.43|63.16|58.06|40.00|56.76|40.00|50.00|50.00|57.14|33.33|41.51|66.67|
|naive 1 + q3_prompt3||64.99|66.70|34.31|62.02|44.18|48.00|23.08|51.85|70.59|49.23|50.00|46.38|34.78|40.00|44.44|52.63|48.00|29.17|66.67|
|naive 2 + q3_prompt3||69.70|67.21|36.58|74.04|48.97|49.38|48.28|54.55|66.67|52.78|35.29|49.44|51.85|53.06|38.10|47.06|43.48|33.33|57.14|
|naive 3 + q3_prompt3||70.82|72.01|40.62|68.75|51.07|57.89|32.00|51.43|63.16|56.25|40.00|53.85|48.00|52.38|50.00|57.14|33.33|41.51|66.67|
|-- main result
|naive 1|template_tq|64.32|65.37|33.25|62.50|43.41|48.00|23.08|51.85|70.59|49.23|50.00|46.38|29.63|35.71|44.44|52.63|48.00|29.17|66.67|
|naive 2|template0  |69.47|66.29|35.94|75.00|48.60|49.38|48.28|54.55|66.67|52.78|35.29|49.44|43.75|52.63|38.10|47.06|43.48|33.33|57.14|
|naive 3|template1  |70.41|71.09|39.67|69.23|50.44|57.89|32.00|51.43|63.16|56.25|40.00|53.85|40.00|50.00|50.00|57.14|33.33|41.51|66.67|
|naive + random 5exemplars 1|random_5shot_prompt1|68.41|69.05|37.33|67.31|48.03|48.10|45.16|56.52|45.45|53.33|57.14|53.16|41.38|26.32|60.87|54.55|50.00|32.26|50.00|
|naive + random 5exemplars 2|random_5shot_prompt2|68.70|68.95|37.37|68.27|48.30|51.28|45.45|55.77|63.16|56.25|40.00|41.46|38.46|52.63|51.85|55.56|40.00|22.73|57.14|
|naive + random 5exemplars 3|random_5shot_prompt3|69.99|71.81|40.17|66.83|50.18|52.05|47.62|61.22|58.82|54.55|40.00|47.89|33.33|41.51|57.14|55.56|34.78|45.00|50.00|
|naive + KATE top5 1|kate_5shot_prompt1|66.79|66.50|35.00|67.31|46.05|46.91|37.04|50.55|55.56|47.89|53.33|50.00|43.75|50.00|60.00|71.43|33.33|27.78|0.00|
|naive + KATE top5 2|kate_5shot_prompt2|64.04|67.42|34.28|58.17|43.14|44.44|27.27|47.42|53.33|49.28|42.11|40.96|43.48|40.82|50.00|70.59|21.05|26.67|57.14|
|naive + KATE top5 3|kate_5shot_prompt3|66.08|70.07|37.16|59.13|45.64|49.28|38.10|48.94|61.54|52.31|42.11|43.90|50.00|45.45|45.45|66.67|21.05|24.39|50.00|
|naive + KATE top5 same relation 1|kate_5shot_same_relation_prompt1|66.43|65.37|34.22|68.27|45.59|43.68|44.44|55.17|57.14|50.70|46.15|40.91|33.33|46.67|66.67|70.59|33.33|31.88|0.00|
|naive + KATE top5 same relation 2|kate_5shot_same_relation_prompt2|66.28|67.62|35.47|63.94|45.63|50.63|44.44|55.10|58.82|50.00|42.11|42.35|38.46|42.31|42.86|58.82|13.33|27.27|50.00|
|naive + KATE top5 same relation 3|kate_5shot_same_relation_prompt3|67.19|69.05|36.84|63.94|46.75|51.28|50.00|53.76|77.78|54.55|36.36|42.86|30.77|47.83|43.48|55.56|33.33|19.51|50.00|
|zeroshotCoT 1|zeroshot_prompt1|65.79|70.17|37.12|58.17|45.32|55.38|0.00|49.44|82.35|48.39|25.00|46.43|34.78|38.36|30.77|61.54|50.00|40.58|50.00|
|zeroshotCoT 2|zeroshot_prompt2|60.25|55.36|27.77|68.75|39.56|40.91|31.58|46.60|54.55|50.60|40.00|36.00|32.26|28.00|44.44|57.14|42.86|28.85|25.00|
|zeroshotCoT 3|zeroshot_prompt3|63.23|60.88|30.77|67.31|42.23|51.22|35.71|51.11|55.56|42.86|28.57|43.37|30.30|46.43|44.44|40.00|40.00|28.24|36.36|
|fewshotCoT 1|randomcot_prompt1|67.74|77.12|46.52|51.44|48.86|51.72|40.00|58.82|83.33|56.60|46.15|30.43|23.53|36.84|57.14|57.14|40.00|47.62|66.67|
|fewshotCoT 2|randomcot_prompt3|67.10|76.10|44.58|51.44|47.77|56.67|38.10|56.41|72.73|59.26|33.33|29.17|21.05|39.13|42.86|66.67|42.11|45.45|57.14|
|fewshotCoT 3|randomcot_prompt3|67.48|77.53|47.27|50.00|48.60|52.63|47.62|50.63|66.67|62.22|66.67|37.50|25.00|52.17|30.77|40.00|28.57|46.81|66.67|
|activeCoT 1|activecot_prompt1|68.38|75.08|43.38|56.73|49.17|50.00|45.45|55.56|77.78|62.50|36.36|38.60|25.00|35.00|55.56|50.00|55.56|46.81|57.14|
|activeCoT 2|activecot_prompt3|67.79|74.97|43.07|55.29|48.42|51.72|45.45|54.12|80.00|52.63|35.29|43.14|30.00|47.62|53.33|58.82|38.10|37.50|57.14|
|activeCoT 3|activecot_prompt3|69.60|73.95|42.30|62.02|50.29|48.28|47.62|61.18|85.71|60.32|50.00|43.64|23.53|46.43|42.86|35.29|50.00|42.86|57.14|
|automateCoT 1|automatecot_prompt1|68.44|75.18|43.54|56.73|49.27|57.58|33.33|56.82|77.78|51.16|22.22|45.28|36.36|39.13|35.29|50.00|45.45|52.38|44.44|
|automateCoT 2|automatecot_prompt3|69.52|75.49|44.24|59.13|50.62|57.97|40.00|56.41|77.78|50.00|20.00|40.82|44.44|49.06|44.44|47.62|40.00|55.56|44.44|
|automateCoT 3|automatecot_prompt3|70.68|77.32|47.31|59.13|52.56|66.67|45.45|61.97|76.92|40.00|25.00|47.83|52.63|50.79|40.00|60.00|35.29|49.32|44.44|
|-- gpt3.5-turbo + system1 typing ~ moe_q1_prompt1
|naive 1||64.41|65.78|33.51|62.02|43.51|48.00|23.08|51.85|70.59|50.00|50.00|47.06|29.63|35.71|44.44|52.63|48.00|29.17|66.67|
|naive 2||69.86|66.91|36.45|75.00|49.06|49.38|48.28|54.55|66.67|55.07|35.29|51.16|43.75|52.63|38.10|47.06|43.48|33.33|57.14|
|naive 3||70.80|71.71|40.34|69.23|50.97|57.89|32.00|51.43|63.16|58.06|40.00|56.76|40.00|50.00|50.00|57.14|33.33|41.51|66.67|
|naive + random 5exemplars 1||68.82|69.97|38.19|66.83|48.60|48.10|45.16|56.52|45.45|55.88|61.54|55.26|41.38|26.32|60.87|54.55|50.00|32.26|50.00|
|naive + random 5exemplars 2||69.15|69.66|38.07|68.27|48.88|51.28|45.45|55.77|63.16|57.14|42.11|44.16|38.46|52.63|51.85|55.56|40.00|22.73|57.14|
|naive + random 5exemplars 3||70.51|72.63|41.12|66.83|50.92|52.05|47.62|61.22|58.82|58.06|42.86|50.00|33.33|41.51|57.14|55.56|34.78|45.00|50.00|
|naive + KATE top5 1||67.31|67.31|35.71|67.31|46.67|46.91|37.04|50.55|55.56|51.52|57.14|51.16|43.75|50.00|60.00|71.43|33.33|27.78|0.00|
|naive + KATE top5 2||64.82|68.64|35.48|58.17|44.08|44.44|27.27|47.42|53.33|53.12|47.06|43.59|43.48|40.82|50.00|70.59|21.05|26.67|57.14|
|naive + KATE top5 3||66.86|71.30|38.56|59.13|46.68|49.28|38.10|48.94|61.54|54.84|47.06|48.00|50.00|45.45|45.45|66.67|21.05|24.39|50.00|
|naive + KATE top5 same relation 1||66.71|66.09|34.73|67.79|45.93|43.68|44.44|55.17|57.14|51.52|46.15|42.86|33.33|46.67|66.67|70.59|33.33|31.88|0.00|
|naive + KATE top5 same relation 2||66.99|68.74|36.54|63.94|46.50|50.63|44.44|55.10|58.82|53.12|47.06|45.00|38.46|42.31|42.86|58.82|13.33|27.27|50.00|
|naive + KATE top5 same relation 3||67.96|70.28|38.11|63.94|47.76|51.28|50.00|53.76|77.78|58.06|40.00|46.15|30.77|47.83|43.48|55.56|33.33|19.51|50.00|
|zeroshotCoT 1||66.12|70.68|37.69|58.17|45.75|55.38|0.00|49.44|82.35|52.63|25.00|46.43|34.78|38.36|30.77|61.54|50.00|40.58|50.00|
|zeroshotCoT 2||61.05|56.89|28.51|68.27|40.23|40.91|31.58|46.60|54.55|54.79|42.11|38.30|32.26|28.00|44.44|57.14|42.86|28.85|25.00|
|zeroshotCoT 3||64.07|62.21|31.67|67.31|43.08|51.22|35.71|51.11|55.56|47.37|31.58|45.00|30.30|46.43|44.44|40.00|40.00|28.24|36.36|
|fewshotCoT 1||67.87|77.32|46.93|51.44|49.08|51.72|40.00|58.82|83.33|58.82|46.15|30.43|23.53|36.84|57.14|57.14|40.00|47.62|66.67|
|fewshotCoT 2||67.23|76.30|44.96|51.44|47.98|56.67|38.10|56.41|72.73|61.54|33.33|29.17|21.05|39.13|42.86|66.67|42.11|45.45|57.14|
|fewshotCoT 3||67.37|77.63|47.47|49.52|48.47|52.63|47.62|50.63|66.67|61.90|66.67|37.50|25.00|52.17|30.77|40.00|28.57|46.81|66.67|
|activeCoT 1||68.44|75.18|43.54|56.73|49.27|50.00|45.45|55.56|77.78|63.83|36.36|38.60|25.00|35.00|55.56|50.00|55.56|46.81|57.14|
|activeCoT 2||67.98|75.28|43.56|55.29|48.73|51.72|45.45|54.12|80.00|54.55|37.50|43.14|30.00|47.62|53.33|58.82|38.10|37.50|57.14|
|activeCoT 3||69.79|74.26|42.72|62.02|50.59|48.28|47.62|61.18|85.71|63.33|50.00|43.64|23.53|46.43|42.86|35.29|50.00|42.86|57.14|
|automateCoT 1||68.57|75.38|43.87|56.73|49.48|57.58|33.33|56.82|77.78|53.66|22.22|45.28|36.36|39.13|35.29|50.00|45.45|52.38|44.44|
|automateCoT 2||69.71|75.79|44.73|59.13|50.93|57.97|40.00|56.41|77.78|53.66|20.00|40.82|44.44|49.06|44.44|47.62|40.00|55.56|44.44|
|automateCoT 3||70.94|77.73|48.05|59.13|53.02|66.67|45.45|61.97|76.92|42.42|33.33|47.83|52.63|50.79|40.00|60.00|35.29|49.32|44.44|
|-- gpt3.5-turbo + system1 temporal ~ moe_q3_prompt3
|naive 1||64.99|66.70|34.31|62.02|44.18|48.00|23.08|51.85|70.59|49.23|50.00|46.38|34.78|40.00|44.44|52.63|48.00|29.17|66.67|
|naive 2||69.70|67.21|36.58|74.04|48.97|49.38|48.28|54.55|66.67|52.78|35.29|49.44|51.85|53.06|38.10|47.06|43.48|33.33|57.14|
|naive 3||70.82|72.01|40.62|68.75|51.07|57.89|32.00|51.43|63.16|56.25|40.00|53.85|48.00|52.38|50.00|57.14|33.33|41.51|66.67|
|naive + random 5exemplars 1||69.00|69.97|38.25|67.31|48.78|48.10|45.16|56.52|45.45|53.33|57.14|53.16|48.00|30.30|60.87|54.55|50.00|32.26|50.00|
|naive + random 5exemplars 2||68.93|69.87|38.15|67.31|48.70|51.28|45.45|55.77|63.16|56.25|40.00|41.46|45.45|54.17|51.85|55.56|40.00|22.73|57.14|
|naive + random 5exemplars 3||70.57|72.73|41.25|66.83|51.01|52.05|47.62|61.22|58.82|54.55|40.00|47.89|38.46|45.83|57.14|55.56|34.78|45.00|50.00|
|naive + KATE top5 1||66.96|67.31|35.57|66.35|46.31|46.91|37.04|50.55|55.56|47.89|53.33|50.00|53.85|48.00|60.00|71.43|33.33|27.78|0.00|
|naive + KATE top5 2||64.08|68.03|34.69|57.21|43.19|44.44|27.27|47.42|53.33|49.28|42.11|40.96|52.63|37.21|50.00|70.59|21.05|26.67|57.14|
|naive + KATE top5 3||66.23|70.58|37.65|58.65|45.86|49.28|38.10|48.94|61.54|52.31|42.11|43.90|60.00|43.90|45.45|66.67|21.05|24.39|50.00|
|naive + KATE top5 same relation 1||66.55|66.39|34.84|66.83|45.80|43.68|44.44|55.17|57.14|50.70|46.15|40.91|40.00|44.90|66.67|70.59|33.33|31.88|0.00|
|naive + KATE top5 same relation 2||66.44|68.44|36.09|62.98|45.88|50.63|44.44|55.10|58.82|50.00|42.11|42.35|47.62|40.00|42.86|58.82|13.33|27.27|50.00|
|naive + KATE top5 same relation 3||67.22|69.66|37.32|62.98|46.87|51.28|50.00|53.76|77.78|54.55|36.36|42.86|40.00|42.86|43.48|55.56|33.33|19.51|50.00|
|zeroshotCoT 1||66.22|71.40|38.39|57.21|45.95|55.38|0.00|49.44|82.35|48.39|25.00|46.43|40.00|40.00|30.77|61.54|50.00|40.58|50.00|
|zeroshotCoT 2||61.03|56.59|28.43|68.75|40.23|40.91|31.58|46.60|54.55|50.60|40.00|36.00|40.00|31.82|44.44|57.14|42.86|28.85|25.00|
|zeroshotCoT 3||63.57|61.70|31.24|66.83|42.57|51.22|35.71|51.11|55.56|42.86|28.57|43.37|33.33|48.98|44.44|40.00|40.00|28.24|36.36|
|fewshotCoT 1||67.87|77.32|46.93|51.44|49.08|51.72|40.00|58.82|83.33|56.60|46.15|30.43|25.00|37.84|57.14|57.14|40.00|47.62|66.67|
|fewshotCoT 2||67.55|76.81|45.92|51.44|48.53|56.67|38.10|56.41|72.73|59.26|33.33|29.17|22.22|45.00|42.86|66.67|42.11|45.45|57.14|
|fewshotCoT 3||67.08|77.73|47.64|48.56|48.10|52.63|47.62|50.63|66.67|62.22|66.67|37.50|26.67|46.15|30.77|40.00|28.57|46.81|66.67|
|activeCoT 1||68.53|75.59|44.15|56.25|49.47|50.00|45.45|55.56|77.78|62.50|36.36|38.60|28.57|33.33|55.56|50.00|55.56|46.81|57.14|
|activeCoT 2||68.05|75.38|43.73|55.29|48.83|51.72|45.45|54.12|80.00|52.63|35.29|43.14|31.58|51.28|53.33|58.82|38.10|37.50|57.14|
|activeCoT 3||69.70|74.67|43.20|61.06|50.60|48.28|47.62|61.18|85.71|60.32|50.00|43.64|25.00|47.83|42.86|35.29|50.00|42.86|57.14|
|automateCoT 1||68.79|76.00|44.83|56.25|49.89|57.58|33.33|56.82|77.78|51.16|22.22|45.28|44.44|40.00|35.29|50.00|45.45|52.38|44.44|
|automateCoT 2||69.49|76.00|44.98|58.17|50.73|57.97|40.00|56.41|77.78|50.00|20.00|40.82|50.00|47.83|44.44|47.62|40.00|55.56|44.44|
|automateCoT 3||70.55|77.94|48.39|57.69|52.63|66.67|45.45|61.97|76.92|40.00|25.00|47.83|58.82|49.06|40.00|60.00|35.29|49.32|44.44|
|-- gpt3.5-turbo + system1 all
|naive 1 + moe (typing + temporal)||65.08|67.11|34.59|61.54|44.29|48.00|23.08|51.85|70.59|50.00|50.00|47.06|34.78|40.00|44.44|52.63|48.00|29.17|66.67|
|naive 2 + moe (typing + temporal)||70.09|67.82|37.11|74.04|49.44|49.38|48.28|54.55|66.67|55.07|35.29|51.16|51.85|53.06|38.10|47.06|43.48|33.33|57.14|
|naive 3 + moe (typing + temporal)||71.21|72.63|41.33|68.75|51.62|57.89|32.00|51.43|63.16|58.06|40.00|56.76|48.00|52.38|50.00|57.14|33.33|41.51|66.67|
|naive + random 5exemplars 1||69.41|70.89|39.15|66.83|49.38|48.10|45.16|56.52|45.45|55.88|61.54|55.26|48.00|30.30|60.87|54.55|50.00|32.26|50.00|
|naive + random 5exemplars 2||69.39|70.58|38.89|67.31|49.30|51.28|45.45|55.77|63.16|57.14|42.11|44.16|45.45|54.17|51.85|55.56|40.00|22.73|57.14|
|naive + random 5exemplars 3||71.09|73.54|42.25|66.83|51.77|52.05|47.62|61.22|58.82|58.06|42.86|50.00|38.46|45.83|57.14|55.56|34.78|45.00|50.00|
|naive + KATE top5 1||67.48|68.13|36.32|66.35|46.94|46.91|37.04|50.55|55.56|51.52|57.14|51.16|53.85|48.00|60.00|71.43|33.33|27.78|0.00|
|naive + KATE top5 2||64.86|69.25|35.95|57.21|44.16|44.44|27.27|47.42|53.33|53.12|47.06|43.59|52.63|37.21|50.00|70.59|21.05|26.67|57.14|
|naive + KATE top5 3||67.01|71.81|39.10|58.65|46.92|49.28|38.10|48.94|61.54|54.84|47.06|48.00|60.00|43.90|45.45|66.67|21.05|24.39|50.00|
|naive + KATE top5 same relation 1||66.83|67.11|35.38|66.35|46.15|43.68|44.44|55.17|57.14|51.52|46.15|42.86|40.00|44.90|66.67|70.59|33.33|31.88|0.00|
|naive + KATE top5 same relation 2||67.16|69.56|37.22|62.98|46.79|50.63|44.44|55.10|58.82|53.12|47.06|45.00|47.62|40.00|42.86|58.82|13.33|27.27|50.00|
|naive + KATE top5 same relation 3||68.00|70.89|38.64|62.98|47.90|51.28|50.00|53.76|77.78|58.06|40.00|46.15|40.00|42.86|43.48|55.56|33.33|19.51|50.00|
|zeroshotCoT 1||66.54|71.91|39.02|57.21|46.39|55.38|0.00|49.44|82.35|52.63|25.00|46.43|40.00|40.00|30.77|61.54|50.00|40.58|50.00|
|zeroshotCoT 2||61.83|58.12|29.22|68.27|40.92|40.91|31.58|46.60|54.55|54.79|42.11|38.30|40.00|31.82|44.44|57.14|42.86|28.85|25.00|
|zeroshotCoT 3||64.41|63.02|32.18|66.83|43.44|51.22|35.71|51.11|55.56|47.37|31.58|45.00|33.33|48.98|44.44|40.00|40.00|28.24|36.36|
|fewshotCoT 1||68.00|77.53|47.35|51.44|49.31|51.72|40.00|58.82|83.33|58.82|46.15|30.43|25.00|37.84|57.14|57.14|40.00|47.62|66.67|
|fewshotCoT 2||67.68|77.02|46.32|51.44|48.75|56.67|38.10|56.41|72.73|61.54|33.33|29.17|22.22|45.00|42.86|66.67|42.11|45.45|57.14|
|fewshotCoT 3||66.97|77.83|47.85|48.08|47.96|52.63|47.62|50.63|66.67|61.90|66.67|37.50|26.67|46.15|30.77|40.00|28.57|46.81|66.67|
|activeCoT 1||68.59|75.69|44.32|56.25|49.58|50.00|45.45|55.56|77.78|63.83|36.36|38.60|28.57|33.33|55.56|50.00|55.56|46.81|57.14|
|activeCoT 2||68.24|75.69|44.23|55.29|49.15|51.72|45.45|54.12|80.00|54.55|37.50|43.14|31.58|51.28|53.33|58.82|38.10|37.50|57.14|
|activeCoT 3||69.89|74.97|43.64|61.06|50.90|48.28|47.62|61.18|85.71|63.33|50.00|43.64|25.00|47.83|42.86|35.29|50.00|42.86|57.14|
|automateCoT 1||68.92|76.20|45.17|56.25|50.11|57.58|33.33|56.82|77.78|53.66|22.22|45.28|44.44|40.00|35.29|50.00|45.45|52.38|44.44|
|automateCoT 2||69.68|76.30|45.49|58.17|51.05|57.97|40.00|56.41|77.78|53.66|20.00|40.82|50.00|47.83|44.44|47.62|40.00|55.56|44.44|
|automateCoT 3||70.80|78.35|49.18|57.69|53.10|66.67|45.45|61.97|76.92|42.42|33.33|47.83|58.82|49.06|40.00|60.00|35.29|49.32|44.44|
|----------------------------------------------------------------------------------------------------------------------|
|-- text-davinci-003
|l2m w/o exemplars 1|least2most_prompt1_no_exemplar|62.12|71.30|36.23|46.15|40.59|45.90|41.67|55.17|76.92|38.96|33.33|48.94|0.00|29.79|36.36|72.73|0.00|0.00|28.57|
|l2m w/o exemplars 2|least2most_prompt2_no_exemplar|58.66|68.34|31.52|41.83|35.95|48.98|11.76|49.23|66.67|22.78|9.52|46.15|0.00|42.62|20.00|57.14|11.76|0.00|40.00|
|l2m w/o exemplars 3|least2most_prompt3_no_exemplar|60.41|64.45|30.66|53.37|38.95|50.00|28.57|45.65|50.00|20.78|10.00|47.62|30.77|46.43|28.57|70.59|23.53|10.00|33.33|
|l2m (3 exemplars) 1|least2most_prompt1|64.64|71.40|37.67|52.88|44.00|45.90|41.67|55.17|76.92|51.95|33.33|51.69|0.00|41.56|36.36|72.73|0.00|0.00|28.57|
|l2m (3 exemplars) 2|least2most_prompt2|64.11|72.22|38.24|50.00|43.33|48.98|11.76|49.23|66.67|58.82|47.06|49.46|0.00|43.04|20.00|57.14|11.76|0.00|40.00|
|l2m (3 exemplars) 3|least2most_prompt3|55.81|61.08|26.43|46.63|33.74|50.00|28.57|45.65|50.00|26.19|9.52|21.21|22.22|34.78|28.57|70.59|23.53|10.00|33.33|
|-- ablation (shouldn't combine. Just show the effect of each constraint. Already has q1_prompt1, q3_prompt3, q1_prompt1 + q3_prompt3)
|naive 1 + q1_prompt2||61.13|78.04|47.48|31.73|38.04|45.90|41.67|55.17|76.92|40.00|50.00|27.78|34.78|8.33|36.36|72.73|0.00|0.00|28.57|
|naive 2 + q1_prompt2||58.48|77.73|45.61|25.00|32.30|48.98|11.76|49.23|66.67|31.25|28.57|21.05|21.05|0.00|20.00|57.14|11.76|0.00|40.00|
|naive 3 + q1_prompt2||62.30|70.48|35.59|48.08|40.90|50.00|28.57|45.65|50.00|54.90|72.73|35.29|36.36|14.81|28.57|70.59|23.53|10.00|33.33|
|naive 1 + q3_prompt1||60.89|77.94|47.10|31.25|37.57|45.90|41.67|55.17|76.92|38.10|40.00|36.36|0.00|0.00|36.36|72.73|0.00|0.00|28.57|
|naive 2 + q3_prompt1||58.20|77.02|43.09|25.48|32.02|48.98|11.76|49.23|66.67|27.91|25.00|26.67|0.00|0.00|20.00|57.14|11.76|0.00|40.00|
|naive 3 + q3_prompt1||61.89|69.56|34.59|48.56|40.40|50.00|28.57|45.65|50.00|48.57|61.54|38.55|28.57|0.00|28.57|70.59|23.53|10.00|33.33|
|naive 1 + (q3_prompt3 on all relations)||58.54|78.65|49.49|23.56|31.92|29.27|33.33|45.83|72.73|33.33|44.44|36.36|26.67|8.70|20.00|72.73|0.00|0.00|28.57|
|naive 2 + (q3_prompt3 on all relations)||55.41|77.32|41.86|17.31|24.49|17.65|0.00|44.90|40.00|26.32|28.57|26.67|26.67|0.00|0.00|57.14|11.76|0.00|40.00|
|naive 3 + (q3_prompt3 on all relations)||58.99|72.73|35.61|35.10|35.35|29.79|30.00|43.33|46.15|44.90|54.55|38.55|25.00|8.70|23.53|70.59|23.53|10.00|33.33|
|-- main result ~ naive 3 x (template1) is too bad
|naive 1|template_tq    |61.25|77.12|44.87|33.65|38.46|45.90|41.67|55.17|76.92|38.10|40.00|36.36|34.78|8.33|36.36|72.73|0.00|0.00|28.57|
|naive 2|template0      |58.16|76.40|41.35|26.44|32.26|48.98|11.76|49.23|66.67|27.91|25.00|26.67|21.05|0.00|20.00|57.14|11.76|0.00|40.00|
|naive 3|batch-template4|62.10|68.23|33.75|51.44|40.76|50.00|28.57|45.65|50.00|48.57|61.54|38.55|36.36|14.81|28.57|70.59|23.53|10.00|33.33|
|naive + random 5exemplars 1|random_5shot_prompt1|67.70|65.99|35.08|70.67|46.89|47.19|50.00|56.84|44.44|51.22|31.58|44.19|33.33|44.44|70.59|60.00|42.11|30.19|44.44|
|naive + random 5exemplars 2|random_5shot_prompt2|70.69|73.75|42.37|65.38|51.42|54.29|23.53|56.18|71.43|54.29|53.33|49.38|34.48|54.55|60.00|58.82|33.33|46.15|66.67|
|naive + random 5exemplars 3|random_5shot_prompt3|69.53|76.61|45.95|57.21|50.96|52.31|44.44|64.10|46.15|47.46|44.44|53.16|37.04|48.65|50.00|71.43|14.29|46.67|50.00|
|naive + KATE top5 1|kate_5shot_prompt1|66.44|64.56|33.80|69.71|45.53|45.98|43.75|48.48|70.00|43.04|38.10|46.60|35.71|47.27|62.50|61.54|40.00|32.73|44.44|
|naive + KATE top5 2|kate_5shot_prompt2|68.75|70.68|38.75|65.38|48.66|51.43|40.00|47.83|62.50|48.48|44.44|47.92|40.00|56.60|52.63|66.67|40.00|38.71|50.00|
|naive + KATE top5 3|kate_5shot_prompt3|67.57|74.36|42.18|55.77|48.03|50.00|40.00|53.16|66.67|43.75|50.00|47.62|45.45|50.00|50.00|83.33|26.67|32.26|50.00|
|naive + KATE top5 same relation 1|kate_5shot_same_relation_prompt1|67.23|64.15|33.93|72.60|46.25|44.44|46.67|49.48|56.00|49.35|28.57|47.52|37.50|46.43|66.67|66.67|45.45|29.09|50.00|
|naive + KATE top5 same relation 2|kate_5shot_same_relation_prompt2|70.41|71.09|39.67|69.23|50.44|48.10|44.44|51.06|63.64|50.00|50.00|47.92|46.15|56.00|60.00|85.71|31.58|46.67|40.00|
|naive + KATE top5 same relation 3|kate_5shot_same_relation_prompt3|66.05|72.52|39.45|54.81|45.88|42.86|45.45|46.91|57.14|43.08|57.14|48.19|50.00|46.51|50.00|83.33|26.67|28.57|40.00|
|zeroshotCoT 1|zeroshot_prompt1|61.91|79.26|51.97|31.73|39.40|47.06|42.11|51.52|76.92|46.51|33.33|23.53|40.00|14.81|36.36|66.67|15.38|0.00|40.00|
|zeroshotCoT 2|zeroshot_prompt2|62.02|76.40|43.50|37.02|40.00|36.36|52.17|57.58|66.67|44.90|20.00|40.00|40.00|8.33|33.33|61.54|28.57|8.70|25.00|
|zeroshotCoT 3|zeroshot_prompt3|61.48|76.10|42.61|36.06|39.06|37.04|23.53|47.06|57.14|53.85|20.00|44.44|28.57|26.67|37.50|66.67|15.38|15.38|33.33|
|fewshotCoT 1||68.25|63.53|34.05|76.44|47.11|43.48|45.16|57.69|63.64|49.35|47.06|45.00|34.78|48.39|42.86|52.17|51.61|34.67|40.00|
|fewshotCoT 2||65.45|62.72|32.52|70.19|44.44|45.33|35.71|52.08|66.67|48.57|38.10|50.00|34.78|47.27|55.56|54.55|48.28|28.07|36.36|
|fewshotCoT 3||66.90|59.75|31.98|79.33|45.58|48.78|48.28|56.84|55.56|47.06|36.36|51.61|46.67|50.00|52.63|63.16|46.15|25.37|33.33|
|activeCoT 1||70.34|74.57|43.23|62.98|51.27|53.12|43.48|54.55|76.92|49.12|42.86|39.39|36.36|54.90|70.59|70.59|50.00|51.61|50.00|
|activeCoT 2||71.97|73.54|42.48|69.23|52.65|50.00|48.00|58.54|66.67|50.00|50.00|41.18|43.48|55.74|73.68|70.59|57.14|50.85|44.44|
|activeCoT 3||67.69|68.74|36.83|65.87|47.24|44.74|53.85|54.76|62.50|49.28|42.86|41.98|32.00|41.79|63.64|66.67|40.00|42.86|44.44|
|automateCoT 1||69.37|78.86|50.23|52.88|51.52|50.79|13.33|51.28|83.33|53.85|50.00|36.36|42.86|47.06|53.33|92.31|53.33|63.41|66.67|
|automateCoT 2||67.50|79.78|52.75|46.15|49.23|53.85|15.38|58.82|44.44|44.90|22.22|40.00|33.33|48.78|57.14|76.92|37.50|59.46|57.14|
|automateCoT 3||70.08|71.40|39.83|67.79|50.18|48.57|45.45|56.79|76.92|56.72|42.11|50.75|38.10|52.63|62.50|70.59|42.11|36.59|36.36|
|-- text-davinci-003 + system1 typing ~ moe_q1_prompt1
|naive 1||61.64|77.73|46.67|33.65|39.11|45.90|41.67|55.17|76.92|41.03|44.44|38.10|34.78|8.33|36.36|72.73|0.00|0.00|28.57|
|naive 2||58.75|77.32|44.35|26.44|33.13|48.98|11.76|49.23|66.67|32.43|25.00|28.57|21.05|0.00|20.00|57.14|11.76|0.00|40.00|
|naive 3||63.14|69.87|35.55|51.44|42.04|50.00|28.57|45.65|50.00|53.97|61.54|43.24|36.36|14.81|28.57|70.59|23.53|10.00|33.33|
|naive + random 5exemplars 1||68.77|68.23|36.90|69.71|48.25|47.19|50.00|56.84|44.44|57.97|33.33|48.65|33.33|44.44|70.59|60.00|42.11|30.19|44.44|
|naive + random 5exemplars 2||71.43|75.18|44.26|64.90|52.63|54.29|23.53|56.18|71.43|59.38|53.33|53.52|34.48|54.55|60.00|58.82|33.33|46.15|66.67|
|naive + random 5exemplars 3||70.26|78.04|48.56|56.73|52.33|52.31|44.44|64.10|46.15|51.85|44.44|58.82|37.04|48.65|50.00|71.43|14.29|46.67|50.00|
|naive + KATE top5 1||67.69|66.80|35.56|69.23|46.98|45.98|43.75|48.48|70.00|50.75|40.00|50.00|35.71|47.27|62.50|61.54|40.00|32.73|44.44|
|naive + KATE top5 2||69.68|72.42|40.66|64.90|50.00|51.43|40.00|47.83|62.50|55.17|44.44|51.76|40.00|56.60|52.63|66.67|40.00|38.71|50.00|
|naive + KATE top5 3||68.57|76.20|45.10|55.29|49.68|50.00|40.00|53.16|66.67|51.85|50.00|51.35|45.45|50.00|50.00|83.33|26.67|32.26|50.00|
|naive + KATE top5 same relation 1||68.31|66.39|35.56|71.63|47.53|44.44|46.67|49.48|56.00|57.14|31.58|50.55|37.50|46.43|66.67|66.67|45.45|29.09|50.00|
|naive + KATE top5 same relation 2||71.10|72.73|41.40|68.27|51.54|48.10|44.44|51.06|63.64|57.63|53.33|48.84|46.15|56.00|60.00|85.71|31.58|46.67|40.00|
|naive + KATE top5 same relation 3||66.74|74.16|41.64|53.85|46.96|42.86|45.45|46.91|57.14|50.00|61.54|49.32|50.00|46.51|50.00|83.33|26.67|28.57|40.00|
|zeroshotCoT 1||62.17|79.67|53.66|31.73|39.88|47.06|42.11|51.52|76.92|50.00|33.33|24.24|40.00|14.81|36.36|66.67|15.38|0.00|40.00|
|zeroshotCoT 2||62.61|77.32|45.83|37.02|40.96|36.36|52.17|57.58|66.67|50.00|22.22|42.55|40.00|8.33|33.33|61.54|28.57|8.70|25.00|
|zeroshotCoT 3||61.93|76.81|44.38|36.06|39.79|37.04|23.53|47.06|57.14|58.33|22.22|46.51|28.57|26.67|37.50|66.67|15.38|15.38|33.33|
|fewshotCoT 1||69.43|65.68|35.59|75.96|48.47|43.48|45.16|57.69|63.64|56.72|47.06|50.75|34.78|48.39|42.86|52.17|51.61|34.67|40.00|
|fewshotCoT 2||66.24|64.25|33.56|69.71|45.31|45.33|35.71|52.08|66.67|52.31|38.10|55.88|34.78|47.27|55.56|54.55|48.28|28.07|36.36|
|fewshotCoT 3||67.72|61.59|33.00|78.37|46.44|48.78|48.28|56.84|55.56|53.33|36.36|54.32|46.67|50.00|52.63|63.16|46.15|25.37|33.33|
|activeCoT 1||71.11|75.79|45.02|62.98|52.51|53.12|43.48|54.55|76.92|52.83|42.86|44.83|36.36|54.90|70.59|70.59|50.00|51.61|50.00|
|activeCoT 2||73.27|75.59|45.14|69.23|54.65|50.00|48.00|58.54|66.67|59.26|50.00|48.28|43.48|55.74|73.68|70.59|57.14|50.85|44.44|
|activeCoT 3||68.99|70.79|38.92|65.87|48.93|44.74|53.85|54.76|62.50|58.62|42.86|47.22|32.00|41.79|63.64|66.67|40.00|42.86|44.44|
|automateCoT 1||69.89|79.67|52.13|52.88|52.51|50.79|13.33|51.28|83.33|58.33|50.00|40.00|42.86|47.06|53.33|92.31|53.33|63.41|66.67|
|automateCoT 2||68.02|80.59|55.17|46.15|50.26|53.85|15.38|58.82|44.44|48.89|22.22|43.48|33.33|48.78|57.14|76.92|37.50|59.46|57.14|
|automateCoT 3||70.79|72.52|41.11|67.79|51.18|48.57|45.45|56.79|76.92|60.32|42.11|56.67|38.10|52.63|62.50|70.59|42.11|36.59|36.36|
|-- text-davinci-003 + system1 temporal ~ moe_q3_prompt3
|naive 1||61.22|77.63|46.26|32.69|38.31|45.90|41.67|55.17|76.92|38.10|40.00|36.36|26.67|8.70|36.36|72.73|0.00|0.00|28.57|
|naive 2||58.42|76.81|42.64|26.44|32.64|48.98|11.76|49.23|66.67|27.91|25.00|26.67|26.67|0.00|20.00|57.14|11.76|0.00|40.00|
|naive 3||61.72|68.74|33.88|49.52|40.23|50.00|28.57|45.65|50.00|48.57|61.54|38.55|25.00|8.70|28.57|70.59|23.53|10.00|33.33|
|naive + random 5exemplars 1||67.29|67.01|35.52|67.79|46.61|47.19|50.00|56.84|44.44|51.22|31.58|44.19|20.00|42.86|70.59|60.00|42.11|30.19|44.44|
|naive + random 5exemplars 2||69.79|74.26|42.72|62.02|50.59|54.29|23.53|56.18|71.43|54.29|53.33|49.38|30.00|41.18|60.00|58.82|33.33|46.15|66.67|
|naive + random 5exemplars 3||68.30|76.61|45.71|53.85|49.45|52.31|44.44|64.10|46.15|47.46|44.44|53.16|21.05|32.26|50.00|71.43|14.29|46.67|50.00|
|naive + KATE top5 1||65.73|65.37|33.91|66.35|44.88|45.98|43.75|48.48|70.00|43.04|38.10|46.60|22.22|41.86|62.50|61.54|40.00|32.73|44.44|
|naive + KATE top5 2||67.36|70.99|38.48|61.06|47.21|51.43|40.00|47.83|62.50|48.48|44.44|47.92|22.22|45.45|52.63|66.67|40.00|38.71|50.00|
|naive + KATE top5 3||66.41|74.46|41.92|52.40|46.58|50.00|40.00|53.16|66.67|43.75|50.00|47.62|28.57|37.84|50.00|83.33|26.67|32.26|50.00|
|naive + KATE top5 same relation 1||66.48|65.17|34.13|68.75|45.61|44.44|46.67|49.48|56.00|49.35|28.57|47.52|20.00|42.86|66.67|66.67|45.45|29.09|50.00|
|naive + KATE top5 same relation 2||68.83|71.09|39.13|64.90|48.82|48.10|44.44|51.06|63.64|50.00|50.00|47.92|23.53|43.90|60.00|85.71|31.58|46.67|40.00|
|naive + KATE top5 same relation 3||64.65|72.52|38.83|50.96|44.07|42.86|45.45|46.91|57.14|43.08|57.14|48.19|25.00|34.29|50.00|83.33|26.67|28.57|40.00|
|zeroshotCoT 1||62.06|79.78|54.17|31.25|39.63|47.06|42.11|51.52|76.92|46.51|33.33|23.53|36.36|16.67|36.36|66.67|15.38|0.00|40.00|
|zeroshotCoT 2||62.06|77.02|44.91|36.06|40.00|36.36|52.17|57.58|66.67|44.90|20.00|40.00|30.77|9.52|33.33|61.54|28.57|8.70|25.00|
|zeroshotCoT 3||61.28|76.61|43.64|34.62|38.61|37.04|23.53|47.06|57.14|53.85|20.00|44.44|26.67|16.00|37.50|66.67|15.38|15.38|33.33|
|fewshotCoT 1||67.73|64.66|34.39|73.08|46.77|43.48|45.16|57.69|63.64|49.35|47.06|45.00|13.33|48.89|42.86|52.17|51.61|34.67|40.00|
|fewshotCoT 2||65.22|63.74|32.87|67.79|44.27|45.33|35.71|52.08|66.67|48.57|38.10|50.00|26.67|46.51|55.56|54.55|48.28|28.07|36.36|
|fewshotCoT 3||66.08|60.67|31.98|75.48|44.92|48.78|48.28|56.84|55.56|47.06|36.36|51.61|30.00|48.89|52.63|63.16|46.15|25.37|33.33|
|activeCoT 1||69.19|74.97|43.46|59.13|50.10|53.12|43.48|54.55|76.92|49.12|42.86|39.39|14.29|46.15|70.59|70.59|50.00|51.61|50.00|
|activeCoT 2||70.54|74.06|42.68|64.42|51.34|50.00|48.00|58.54|66.67|50.00|50.00|41.18|15.38|47.83|73.68|70.59|57.14|50.85|44.44|
|activeCoT 3||66.70|69.66|37.10|61.54|46.29|44.74|53.85|54.76|62.50|49.28|42.86|41.98|12.50|32.65|63.64|66.67|40.00|42.86|44.44|
|automateCoT 1||68.69|79.16|50.97|50.48|50.72|50.79|13.33|51.28|83.33|53.85|50.00|36.36|18.18|43.90|53.33|92.31|53.33|63.41|66.67|
|automateCoT 2||66.51|79.88|53.25|43.27|47.75|53.85|15.38|58.82|44.44|44.90|22.22|40.00|0.00|37.50|57.14|76.92|37.50|59.46|57.14|
|automateCoT 3||68.83|71.91|39.88|63.46|48.98|48.57|45.45|56.79|76.92|56.72|42.11|50.75|14.29|43.90|62.50|70.59|42.11|36.59|36.36|
|-- text-davinci-003 + system1 all
|naive 1||61.61|78.24|48.23|32.69|38.97|45.90|41.67|55.17|76.92|41.03|44.44|38.10|26.67|8.70|36.36|72.73|0.00|0.00|28.57|
|naive 2||59.01|77.73|45.83|26.44|33.54|48.98|11.76|49.23|66.67|32.43|25.00|28.57|26.67|0.00|20.00|57.14|11.76|0.00|40.00|
|naive 3||62.76|70.38|35.76|49.52|41.53|50.00|28.57|45.65|50.00|53.97|61.54|43.24|25.00|8.70|28.57|70.59|23.53|10.00|33.33|
|naive + random 5exemplars 1||68.37|69.25|37.47|66.83|48.01|47.19|50.00|56.84|44.44|57.97|33.33|48.65|20.00|42.86|70.59|60.00|42.11|30.19|44.44|
|naive + random 5exemplars 2||70.52|75.69|44.76|61.54|51.82|54.29|23.53|56.18|71.43|59.38|53.33|53.52|30.00|41.18|60.00|58.82|33.33|46.15|66.67|
|naive + random 5exemplars 3||69.03|78.04|48.47|53.37|50.80|52.31|44.44|64.10|46.15|51.85|44.44|58.82|21.05|32.26|50.00|71.43|14.29|46.67|50.00|
|naive + KATE top5 1||66.98|67.62|35.77|65.87|46.36|45.98|43.75|48.48|70.00|50.75|40.00|50.00|22.22|41.86|62.50|61.54|40.00|32.73|44.44|
|naive + KATE top5 2||68.29|72.73|40.51|60.58|48.55|51.43|40.00|47.83|62.50|55.17|44.44|51.76|22.22|45.45|52.63|66.67|40.00|38.71|50.00|
|naive + KATE top5 3||67.40|76.30|45.00|51.92|48.21|50.00|40.00|53.16|66.67|51.85|50.00|51.35|28.57|37.84|50.00|83.33|26.67|32.26|50.00|
|naive + KATE top5 same relation 1||67.55|67.42|35.88|67.79|46.92|44.44|46.67|49.48|56.00|57.14|31.58|50.55|20.00|42.86|66.67|66.67|45.45|29.09|50.00|
|naive + KATE top5 same relation 2||69.52|72.73|40.92|63.94|49.91|48.10|44.44|51.06|63.64|57.63|53.33|48.84|23.53|43.90|60.00|85.71|31.58|46.67|40.00|
|naive + KATE top5 same relation 3||65.34|74.16|41.11|50.00|45.12|42.86|45.45|46.91|57.14|50.00|61.54|49.32|25.00|34.29|50.00|83.33|26.67|28.57|40.00|
|zeroshotCoT 1||62.32|80.18|56.03|31.25|40.12|47.06|42.11|51.52|76.92|50.00|33.33|24.24|36.36|16.67|36.36|66.67|15.38|0.00|40.00|
|zeroshotCoT 2||62.65|77.94|47.47|36.06|40.98|36.36|52.17|57.58|66.67|50.00|22.22|42.55|30.77|9.52|33.33|61.54|28.57|8.70|25.00|
|zeroshotCoT 3||61.73|77.32|45.57|34.62|39.34|37.04|23.53|47.06|57.14|58.33|22.22|46.51|26.67|16.00|37.50|66.67|15.38|15.38|33.33|
|fewshotCoT 1||68.92|66.80|36.04|72.60|48.17|43.48|45.16|57.69|63.64|56.72|47.06|50.75|13.33|48.89|42.86|52.17|51.61|34.67|40.00|
|fewshotCoT 2||66.01|65.27|33.98|67.31|45.16|45.33|35.71|52.08|66.67|52.31|38.10|55.88|26.67|46.51|55.56|54.55|48.28|28.07|36.36|
|fewshotCoT 3||66.90|62.51|33.05|74.52|45.79|48.78|48.28|56.84|55.56|53.33|36.36|54.32|30.00|48.89|52.63|63.16|46.15|25.37|33.33|
|activeCoT 1||69.97|76.20|45.39|59.13|51.36|53.12|43.48|54.55|76.92|52.83|42.86|44.83|14.29|46.15|70.59|70.59|50.00|51.61|50.00|
|activeCoT 2||71.84|76.10|45.58|64.42|53.39|50.00|48.00|58.54|66.67|59.26|50.00|48.28|15.38|47.83|73.68|70.59|57.14|50.85|44.44|
|activeCoT 3||67.99|71.71|39.38|61.54|48.03|44.74|53.85|54.76|62.50|58.62|42.86|47.22|12.50|32.65|63.64|66.67|40.00|42.86|44.44|
|automateCoT 1||69.21|79.98|53.03|50.48|51.72|50.79|13.33|51.28|83.33|58.33|50.00|40.00|18.18|43.90|53.33|92.31|53.33|63.41|66.67|
|automateCoT 2||67.03|80.69|55.90|43.27|48.78|53.85|15.38|58.82|44.44|48.89|22.22|43.48|0.00|37.50|57.14|76.92|37.50|59.46|57.14|
|automateCoT 3||69.54|73.03|41.25|63.46|50.00|48.57|45.45|56.79|76.92|60.32|42.11|56.67|14.29|43.90|62.50|70.59|42.11|36.59|36.36|
|----------------------------------------------------------------------------------------------------------------------|
|random (p=0.5)||-|50|20|50|28.57|-
|human annotator 1|human1|94.35|96.63|93.53|90.38|91.93|94.55|100.00|89.19|100.00|93.33|100.00|92.00|100.00|85.71|94.12|54.55|94.12|91.89|100.00|
|human annotator 2|human2|92.45|96.12|95.21|86.06|90.40|85.71|85.71|91.18|92.31|90.91|80.00|96.30|93.33|94.12|87.50|92.31|94.12|88.89|66.67|
|previous best 1|pseudoreasoner1|66.85|60.78|32.33|77.40|45.61|47.06|50.00|50.00|38.89|50.00|40.00|58.23|43.24|36.07|21.43|46.15|45.16|37.68|60.00|
|previous best 2|pseudoreasoner2|65.52|60.06|31.52|75.00|44.38|43.48|50.00|49.56|40.00|52.46|36.36|57.14|37.50|29.51|26.67|46.15|42.86|40.58|44.44|
|previous best 3|pseudoreasoner3|67.02|60.78|32.40|77.88|45.76|43.01|50.00|42.48|38.71|53.73|42.11|60.00|44.44|40.00|38.46|54.55|38.10|39.51|60.00|


Aggregated
```
chatgpt
>0> 67.58 & 36.29 & 68.91 & 52.75 & 41.76 & 49.89 & 37.79 & 46.11 & 47.48
>0> 68.13 & 36.77 & 68.75 & 54.38 & 41.76 & 51.66 & 37.79 & 46.11 & 47.85
>0> 68.64 & 37.17 & 68.27 & 52.75 & 41.76 & 49.89 & 44.88 & 48.48 & 48.07
>0> 69.19 & 37.68 & 68.11 & 54.38 & 41.76 & 51.66 & 44.88 & 48.48 & 48.45
>1> 69.94 & 38.29 & 67.47 & 54.71 & 45.71 & 47.5 & 37.72 & 40.15 & 48.84
>1> 70.75 & 39.13 & 67.31 & 57.03 & 48.84 & 49.81 & 37.72 & 40.15 & 49.47
>1> 70.86 & 39.22 & 67.15 & 54.71 & 45.71 & 47.5 & 43.97 & 43.43 & 49.5
>1> 71.67 & 40.1 & 66.99 & 57.03 & 48.84 & 49.81 & 43.97 & 43.43 & 50.15
>2> 68.0 & 35.48 & 61.54 & 49.83 & 45.85 & 44.95 & 45.74 & 45.42 & 44.94
>2> 69.08 & 36.58 & 61.54 & 53.16 & 50.42 & 47.58 & 45.74 & 45.42 & 45.81
>2> 68.64 & 35.97 & 60.74 & 49.83 & 45.85 & 44.95 & 55.49 & 43.04 & 45.12
>2> 69.73 & 37.12 & 60.74 & 53.16 & 50.42 & 47.58 & 55.49 & 43.04 & 46.01
>3> 67.35 & 35.51 & 65.38 & 51.75 & 41.54 & 42.04 & 34.19 & 45.6 & 45.99
>3> 68.37 & 36.46 & 65.22 & 54.23 & 44.4 & 44.67 & 34.19 & 45.6 & 46.73
>3> 68.16 & 36.08 & 64.26 & 51.75 & 41.54 & 42.04 & 42.54 & 42.59 & 46.18
>3> 69.19 & 37.08 & 64.1 & 54.23 & 44.4 & 44.67 & 42.54 & 42.59 & 46.95
>4> 62.14 & 31.89 & 64.74 & 47.28 & 31.19 & 41.93 & 32.45 & 37.6 & 42.37
>4> 63.26 & 32.62 & 64.58 & 51.6 & 32.9 & 43.24 & 32.45 & 37.6 & 43.02
>4> 63.23 & 32.69 & 64.26 & 47.28 & 31.19 & 41.93 & 37.78 & 40.27 & 42.92
>4> 64.35 & 33.47 & 64.1 & 51.6 & 32.9 & 43.24 & 37.78 & 40.27 & 43.58
>5> 76.92 & 46.12 & 50.96 & 59.36 & 48.72 & 32.37 & 23.19 & 42.71 & 48.41
>5> 77.08 & 46.45 & 50.8 & 60.75 & 48.72 & 32.37 & 23.19 & 42.71 & 48.51
>5> 77.29 & 46.83 & 50.48 & 59.36 & 48.72 & 32.37 & 24.63 & 43.0 & 48.57
>5> 77.46 & 47.17 & 50.32 & 60.75 & 48.72 & 32.37 & 24.63 & 43.0 & 48.67
>6> 74.67 & 42.92 & 58.01 & 58.48 & 40.55 & 41.79 & 26.18 & 43.02 & 49.29
>6> 74.91 & 43.27 & 58.01 & 60.57 & 41.29 & 41.79 & 26.18 & 43.02 & 49.53
>6> 75.21 & 43.69 & 57.53 & 58.48 & 40.55 & 41.79 & 28.38 & 44.15 & 49.63
>6> 75.45 & 44.06 & 57.53 & 60.57 & 41.29 & 41.79 & 28.38 & 44.15 & 49.88
>7> 76.0 & 45.03 & 58.33 & 47.05 & 22.41 & 44.64 & 44.48 & 46.33 & 50.82
>7> 76.3 & 45.55 & 58.33 & 49.91 & 25.18 & 44.64 & 44.48 & 46.33 & 51.14
>7> 76.65 & 46.07 & 57.37 & 47.05 & 22.41 & 44.64 & 51.09 & 45.63 & 51.08
>7> 76.95 & 46.61 & 57.37 & 49.91 & 25.18 & 44.64 & 51.09 & 45.63 & 51.42

text-davinci-003
>0> 73.92 & 39.99 & 37.18 & 38.19 & 42.18 & 33.86 & 30.73 & 7.71 & 37.16
>0> 74.97 & 42.19 & 37.18 & 42.48 & 43.66 & 36.64 & 30.73 & 7.71 & 38.09
>0> 74.39 & 40.93 & 36.22 & 38.19 & 42.18 & 33.86 & 26.11 & 5.8 & 37.06
>0> 75.45 & 43.27 & 36.22 & 42.48 & 43.66 & 36.64 & 26.11 & 5.8 & 38.01
>1> 72.12 & 41.13 & 64.42 & 50.99 & 43.12 & 48.91 & 34.95 & 49.21 & 49.76
>1> 73.82 & 43.24 & 63.78 & 56.4 & 43.7 & 53.66 & 34.95 & 49.21 & 51.07
>1> 72.63 & 41.32 & 61.22 & 50.99 & 43.12 & 48.91 & 23.68 & 38.77 & 48.88
>1> 74.33 & 43.57 & 60.58 & 56.4 & 43.7 & 53.66 & 23.68 & 38.77 & 50.21
>2> 69.87 & 38.24 & 63.62 & 45.09 & 44.18 & 47.38 & 40.39 & 51.29 & 47.41
>2> 71.81 & 40.44 & 63.14 & 52.59 & 44.81 & 51.04 & 40.39 & 51.29 & 48.89
>2> 70.27 & 38.1 & 59.94 & 45.09 & 44.18 & 47.38 & 24.34 & 41.72 & 46.22
>2> 72.22 & 40.43 & 59.46 & 52.59 & 44.81 & 51.04 & 24.34 & 41.72 & 47.71
>3> 69.25 & 37.68 & 65.55 & 47.48 & 45.24 & 47.88 & 44.55 & 49.65 & 47.52
>3> 71.09 & 39.53 & 64.58 & 54.92 & 48.82 & 49.57 & 44.55 & 49.65 & 48.68
>3> 69.59 & 37.36 & 61.54 & 47.48 & 45.24 & 47.88 & 22.84 & 40.35 & 46.17
>3> 71.44 & 39.3 & 60.58 & 54.92 & 48.82 & 49.57 & 22.84 & 40.35 & 47.32
>4> 77.25 & 46.03 & 34.94 & 48.42 & 24.44 & 35.99 & 36.19 & 16.6 & 39.49
>4> 77.93 & 47.96 & 34.94 & 52.78 & 25.92 & 37.77 & 36.19 & 16.6 & 40.21
>4> 77.8 & 47.57 & 33.98 & 48.42 & 24.44 & 35.99 & 31.27 & 14.06 & 39.41
>4> 78.48 & 49.69 & 33.98 & 52.78 & 25.92 & 37.77 & 31.27 & 14.06 & 40.15
>5> 62.0 & 32.85 & 75.32 & 48.33 & 40.51 & 48.87 & 38.74 & 48.55 & 45.71
>5> 63.84 & 34.05 & 74.68 & 54.12 & 40.51 & 53.65 & 38.74 & 48.55 & 46.74
>5> 63.02 & 33.08 & 72.12 & 48.33 & 40.51 & 48.87 & 23.33 & 48.1 & 45.32
>5> 64.86 & 34.36 & 71.48 & 54.12 & 40.51 & 53.65 & 23.33 & 48.1 & 46.37
>6> 72.28 & 40.85 & 66.03 & 49.47 & 45.24 & 40.85 & 37.28 & 50.81 & 50.39
>6> 74.06 & 43.03 & 66.03 & 56.9 & 45.24 & 46.78 & 37.28 & 50.81 & 52.03
>6> 72.9 & 41.08 & 61.7 & 49.47 & 45.24 & 40.85 & 14.06 & 42.21 & 49.24
>6> 74.67 & 43.45 & 61.7 & 56.9 & 45.24 & 46.78 & 14.06 & 42.21 & 50.93
>7> 76.68 & 47.6 & 55.61 & 51.82 & 38.11 & 42.37 & 38.1 & 49.49 & 50.31
>7> 77.59 & 49.47 & 55.61 & 55.85 & 38.11 & 46.72 & 38.1 & 49.49 & 51.32
>7> 76.98 & 48.03 & 52.4 & 51.82 & 38.11 & 42.37 & 10.82 & 41.77 & 49.15
>7> 77.9 & 50.06 & 52.4 & 55.85 & 38.11 & 46.72 & 10.82 & 41.77 & 50.17
```

Pilot study
```
|75.35|76.47|52.78|73.08|61.29|66.67|0.00|66.67|0.00|66.67|100.00|75.00|50.00|50.00|0.00|0.00|0.00|100.00|0.00|
|76.01|77.45|54.29|73.08|62.30|66.67|0.00|66.67|0.00|72.73|100.00|75.00|50.00|50.00|0.00|0.00|0.00|100.00|0.00|
|77.33|79.41|57.58|73.08|64.41|66.67|0.00|66.67|0.00|66.67|100.00|75.00|100.00|57.14|0.00|0.00|0.00|100.00|0.00|
|55.62|71.57|40.00|23.08|29.27|57.14|0.00|0.00|0.00|25.00|0.00|57.14|66.67|0.00|0.00|0.00|0.00|0.00|0.00|

taken_fields = [4,9,10,11,12,13,5,7,17,14]

results = """<copy result of baselines here>"""
results = results.splitlines()

for i in range(len(results)):
  score = results[i][:-1].rsplit('|', 19)[1:]
  print(' & '.join([score[_] for _ in taken_fields]))

Constraint & All & xReact & oReact & xAttr & xIntent & xNeed & xWant & xEffect & HinderedBy & Causes
N/A (Baseline) & 61.29 & 66.67 & 100.00 & 75.00 & 50.00 & 50.00 & 66.67 & 66.67 & 100.00 & 0.00
Typing & 72.73 & 62.30 & 100.00 & 75.00 & 50.00 & 50.00 & 66.67 & 66.67 & 100.00 & 0.00
Temporal & 64.41 & 66.67 & 100.00 & 75.00 & 100.00 & 57.14 & 66.67 & 66.67 & 100.00 & 0.00
Ambiguity & 29.27 & 25.00 & 0.00 & 57.14 & 66.67 & 0.00 & 57.14 & 0.00 & 0.00 & 0.00

|Constraint | All | xReact | oReact | xAttr | xIntent | xNeed | xWant | xEffect | HinderedBy | Causes
|---|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|
|N/A (Baseline) | 61.29 | 66.67 | 100.00 | 75.00 | 50.00 | 50.00 | 66.67 | 66.67 | 100.00 | 0.00
|Typing | 62.30 | 72.73 | 100.00 | 75.00 | 50.00 | 50.00 | 66.67 | 66.67 | 100.00 | 0.00
|Temporal | 64.41 | 66.67 | 100.00 | 75.00 | 100.00 | 57.14 | 66.67 | 66.67 | 100.00 | 0.00
|Ambiguity | 29.27 | 25.00 | 0.00 | 57.14 | 66.67 | 0.00 | 57.14 | 0.00 | 0.00 | 0.00
```

Additional statistics

Effect of each prompt engineering method comparing with our method
```
>>> import numpy as np
>>> score = [47.48, 48.84, 44.94, 45.99, 42.37, 48.41, 49.29, 50.82, 37.16, 49.76, 47.41, 47.52, 39.49, 45.71, 50.39, 50.31]
>>> score = np.array(score)

>>> sum1 = sum(score[[0,4,8,12]])
>>> (sum(score)-sum1)/12 - sum1/4
6.657499999999992

>>> sum2 = sum(score[[1,5,9,13]])
>>> (sum(score)-sum1-sum2)/8 - sum2/4
0.15374999999998096

>>> sum3 = sum(score[[0,1,2,3,8,9,10,11]])
>>> (sum(score)-2*sum3)/8
0.9612499999999784

>>> (0.87+1.11)/2
0.99
```

Fail rate in handling explicit constraint
```
>>> df = pd.read_csv('prompting_data/tst_xReact_analysis.csv')
>>> df = df[df['randomcot_chatgpt_prompt3'] == 1]
>>> sum(df['do_satisfy_typing_constraint_gold_label'])
13
>>> len(df)
23
>>> 10/23
0.43478260869565216
```

p-value
```
n = 979
sigma = 0.4
t = 0.1/sqrt(sigma**2 * 2/n) ~ 5
df = n
```

Analysis
```
import numpy as np
M = np.array([
  [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0], # 0
  [0,0,1,0,0,0,3,0,1,0,0,0,2,0,1,0] # 1
])
M[0] = 4 - M[1]
M = M.transpose()

[[4, 4, 3, 4, 4, 4, 1, 4, 3, 4, 4, 4, 2, 4, 3, 4],
 [0, 0, 1, 0, 0, 0, 3, 0, 1, 0, 0, 0, 2, 0, 1, 0]]

def fleiss_kappa(M): # not suitable in our case
  """
  source: https://gist.github.com/skylander86/65c442356377367e27e79ef1fed4adee
  See `Fleiss' Kappa <https://en.wikipedia.org/wiki/Fleiss%27_kappa>`_.
  :param M: a matrix of shape (:attr:`N`, :attr:`k`) where `N` is the number of subjects and `k` is the number of categories into which assignments are made. `M[i, j]` represent the number of raters who assigned the `i`th subject to the `j`th category.
  :type M: numpy matrix
  """
  N, k = M.shape  # N is no. of items, k is no. of categories
  n_annotators = float(np.sum(M[0, :]))  # no. of annotators
  p = np.sum(M, axis=0) / (N * n_annotators)
  P = (np.sum(M * M, axis=1) - n_annotators) / (n_annotators * (n_annotators - 1))
  Pbar = np.sum(P) / N
  PbarE = np.sum(p * p)
  kappa = (Pbar - PbarE) / (1 - PbarE)
  print('Fleiss =', kappa) 

0.23809523809523775
```





## Synthetic-ATOMIC2020

Run the following code to aggregate baseline result
```{=python}
results = """<copy result of baselines here>"""
def parse(results):
  results = results.splitlines()
  taken_fields = [1,4]
  num_baselines = 6
  for i in range(len(results)):
    score = [float(s) for s in results[i][:-1].rsplit('|', 10)[1:]]
    print(f'>{i}>', ' & '.join([str(score[_]) for _ in taken_fields]))
```

Generalizability test (Synthesized from ATOMIC2020 test set, 5 focused relation)
> for convenience, atomic_davinci_naive_prompt2 is temporally renamed to prompt3

Run the following code to get baseline result of each run
```{=bash}
for model in davinci
  do
  for setting in naive random_5shot kate_5shot kate_5shot_same_relation zeroshot randomcot
  do
    for i in 3
    do python prompting/generalizability_scoring.py  \
      --q0 atomic_${model}_${setting}_prompt${i}.txt
    done
  done
done

zeroshotCoT needs special treatment! -> but zeroshotCoT result in CKBPv2 is also bad -> ignore it, no one care!
atomic_davinci_naive_prompt2 also need special treatment! Hmm, cleaned, but seem not good! May need to re-run with true prompt 3

```

naive
random_5shot
kate_5shot 
kate_5shot_same_relation 
zeroshot 
randomcot

|Setting            |AUC  |Acc  |Prec |Rec  |F1   |xReact|oReact|xAttr|xIntent|xNeed|
|---|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|
|---| gpt3.5-turbo
|naive_prompt3      |59.60|59.60|58.82|64.00|61.30|68.49|25.00|53.94|64.71|64.02|
|random_5shot |59.40|59.40|58.94|62.00|60.43|59.86|34.78|49.77|61.24|67.90|
|kate_5shot  |61.30|61.30|61.75|59.40|60.55|61.87|37.50|50.22|63.37|65.73|
|kate_5shot_same_relation  |59.00|59.00|58.96|59.20|59.08|59.42|25.00|51.10|61.85|64.29|
|zeroshot  |49.90|49.90|49.90|50.60|50.25|50.38|4.65|44.65|61.27|50.30|
|randomcot |60.10|60.10|59.40|63.80|61.52|61.87|29.63|40.20|61.22|73.54|
|+ typing constraint|
| |63.40|63.40|63.24|64.00|63.62|75.19|27.59|59.36|64.71|64.02|
| |62.00|62.00|62.00|62.00|62.00|64.71|36.36|53.14|61.24|67.90|
| |63.80|63.80|65.13|59.40|62.13|67.19|40.00|53.27|63.37|65.73|
| |61.70|61.70|62.32|59.20|60.72|66.13|26.09|53.95|61.85|64.29|
| |52.70|52.70|52.82|50.60|51.69|54.10|5.26|47.76|61.27|50.30|
| |62.20|62.20|61.82|63.80|62.80|67.19|29.63|42.33|61.22|73.54|
|+ temporal constraint|
| |58.90|58.90|59.03|58.20|58.61|68.49|25.00|53.94|60.98|59.15|
| |59.30|59.30|59.83|56.60|58.17|59.86|34.78|49.77|58.37|64.18|
| |60.10|60.10|61.56|53.80|57.42|61.87|37.50|50.22|57.66|61.26|
| |58.50|58.50|59.38|53.80|56.45|59.42|25.00|51.10|57.52|60.36|
| |50.40|50.40|50.43|46.40|48.33|50.38|4.65|44.65|59.14|47.13|
| |59.90|59.90|60.21|58.40|59.29|61.87|29.63|40.20|57.78|70.89|
|---| text-davinci-003
| |59.70|59.70|58.35|67.80|62.72|70.34|29.63|62.15|65.94|60.21|
| |57.40|57.40|56.21|67.00|61.13|61.44|16.22|58.73|68.24|61.45|
| |58.50|58.50|57.39|66.00|61.40|62.11|26.67|57.14|65.71|63.64|
| |60.30|60.30|59.21|66.20|62.51|65.79|24.24|58.06|64.68|66.11|
| |58.40|58.40|58.61|57.20|57.89|67.63|29.63|47.39|68.70|54.44|
| |57.00|57.00|55.35|72.40|62.74|63.41|21.62|52.10|60.35|73.49|
|+ typing constraint|
| |62.20|62.20|60.97|67.80|64.20|75.56|32.00|65.55|65.94|60.21|
| |60.20|60.20|58.98|67.00|62.73|66.67|17.14|62.18|68.24|61.45|
| |61.70|61.70|60.77|66.00|63.28|67.11|29.63|61.28|65.71|63.64|
| |63.00|63.00|62.22|66.20|64.15|71.43|25.00|61.54|64.68|66.11|
| |60.80|60.80|61.64|57.20|59.34|72.87|29.63|50.76|68.70|54.44|
| |60.10|60.10|58.11|72.40|64.47|68.42|24.24|55.61|60.35|73.49|
|+ temporal constraint|
| |59.70|59.70|59.13|62.80|60.91|70.34|29.63|62.15|62.40|57.54|
| |57.20|57.20|56.67|61.20|58.85|61.44|16.22|58.73|65.67|56.97|
| |58.50|58.50|58.06|61.20|59.59|62.11|26.67|57.14|63.53|60.18|
| |60.30|60.30|60.08|61.40|60.73|65.79|24.24|58.06|62.60|62.65|
| |58.10|58.10|59.23|52.00|55.38|67.63|29.63|47.39|65.83|49.69|
| |57.40|57.40|56.23|66.80|61.06|63.41|21.62|52.10|58.46|70.89|


gpt3.5
>0> 59.6 & 61.3
>1> 59.4 & 60.43
>2> 61.3 & 60.55
>3> 59.0 & 59.08
>4> 49.9 & 50.25
>5> 60.1 & 61.52

>0> 63.4 & 63.62
>1> 62.0 & 62.0
>2> 63.8 & 62.13
>3> 61.7 & 60.72
>4> 52.7 & 51.69
>5> 62.2 & 62.8

davinci
>0> 59.7 & 62.72
>1> 57.4 & 61.13
>2> 58.5 & 61.4
>3> 60.3 & 62.51
>4> 58.4 & 57.89
>5> 57.0 & 62.74

>0> 62.2 & 64.2
>1> 60.2 & 62.73
>2> 61.7 & 63.28
>3> 63.0 & 64.15
>4> 60.8 & 59.34
>5> 60.1 & 64.47


gpt3.5
59.6 & 61.3
63.4 & 63.62
59.4 & 60.43
62.0 & 62.0
61.3 & 60.55
63.8 & 62.13
59.0 & 59.08
61.7 & 60.72
49.9 & 50.25
52.7 & 51.69
60.1 & 61.52
62.2 & 62.8

davinci
59.7 & 62.72
62.2 & 64.2
57.4 & 61.13
60.2 & 62.73
58.5 & 61.4
61.7 & 63.28
60.3 & 62.51
63.0 & 64.15
58.4 & 57.89
60.8 & 59.34
57.0 & 62.74
60.1 & 64.47

```
results = """<>"""
results = results.splitlines()

for i in range(len(results)//2):
  _, o = results[2*i].split(' & ')
  _, c = results[2*i+1].split(' & ')
  print()
  print("\scriptsize{(+" + str(round(float(c)- float(o), 2)) + ")}")

```


```
aa = [47.48, 48.84, 44.94, 45.99, 42.37, 48.41, 37.16, 49.76, 47.41, 47.52, 39.49, 45.71]
aa = np.array(aa)
examplar = aa[[1,2,3,5, 7,8,9,11]].mean() - aa[[0,4,6,10]].mean()
cot = aa[[4,5, 10,11]].mean() - aa[[0,1,2,3,6,7,8,9]].mean()
```



## LLaMa2

```
for model in llama2-7b
  do
  for setting in naive random_5shot kate_5shot kate_5shot_same_relation
  do
    for i in 3
    do python prompting/llama_scoring.py \
      --q0 tst_${model}_${setting}_prompt${i}.txt
    done
  done
done
```

baselines
55.80|57.20|25.64|53.37|34.63|36.11|9.09|32.26|32.26|34.78|
59.72|72.22|35.59|37.98|36.74|43.14|16.67|48.39|36.36|25.81|
51.92|72.93|26.45|15.38|19.45|5.00|0.00|13.04|22.22|34.48|
54.29|72.52|30.32|22.60|25.90|5.00|0.00|20.00|12.50|33.33|

baselines + constraints
57.87|61.29|27.91|51.92|36.30|47.06|18.18|33.33|32.26|34.78|
60.77|74.16|38.81|37.50|38.14|52.38|25.00|51.85|36.36|25.81|
53.15|74.87|31.37|15.38|20.65|6.67|0.00|15.38|22.22|34.48|
55.48|74.67|34.85|22.12|27.06|6.90|0.00|19.51|12.50|33.33|

55.49|57.81|25.54|51.44|34.13|36.11|9.09|32.26|23.08|32.43|
59.93|72.83|36.45|37.50|36.97|43.14|16.67|48.39|33.33|29.63|
52.18|73.34|27.35|15.38|19.69|5.00|0.00|13.04|25.00|37.04|
54.55|72.93|31.13|22.60|26.18|5.00|0.00|20.00|14.29|35.71|


|Method|Acc|F1|
|---|:-:|:-:|
|Zero-shot   |57.20|34.63|
|~ + \ourmethod{}  |61.29|36.30 (+1.67)|
|Few-shot (Random)   |72.22|36.74|
|~ + \ourmethod{}  |74.16|38.14 (+1.4)|
|Few-shot (KATE)   |72.93|19.45|
|~ + \ourmethod{}  |74.87|20.65 (+1.2)|
|Few-shot (KATE-s)   |72.52|25.90|
|~ + \ourmethod{}  |74.67|27.06 (+1.16)|

[34.63, 36.74, 19.45, 25.90, 36.30, 38.14, 20.65, 27.06]
1.67
1.4
1.2
1.16